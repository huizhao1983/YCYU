!function(c){var o=c.extend({productTypeSelector:"#product-type",ticketTogglerSelector:"input#_ticket",ticketPanels:".show_if_ticket",ticketFieldsSelector:".ticket_fields",productDataMetaBoxSelector:"#woocommerce-product-data",insertFieldSelector:"a.insert",deleteFieldSelector:"a.delete",fieldLabelSelector:".field_label input",fieldTypeSelector:".field_type select",ticketFields:[],labelVariablesInfoSelector:".ticket-label-variables-info",labelVariablesSelector:".ticket-label-variables",ticketLinkVarSelector:".ticket-link-var",ticketTokenVarSelector:".ticket-token-var",ticketPostVarsSelector:".ticket-post-vars"},wcBoxOfficeParams);o.init=function(){o.populateTicketFields(),o.bindEvents(),o.setDefaultFieldsIfEmpty(),o.setDefaultPrintContentIfEmpty(),o.setDefaultEmailContentIfEmpty()},o.bindEvents=function(){c(o.productTypeSelector).on("change",o.maybeUncheckTicket).trigger("change"),c(o.ticketTogglerSelector).on("change",o.toggleTicketPanels).trigger("change"),c(o.productDataMetaBoxSelector).on("click",o.ticketFieldsSelector+" "+o.insertFieldSelector,o.insertField),c(o.productDataMetaBoxSelector).on("click",o.ticketFieldsSelector+" "+o.deleteFieldSelector,o.deleteField),c(o.productDataMetaBoxSelector).on("change",o.fieldTypeSelector,o.fieldTypeChange),c(o.ticketFieldsSelector).on("change",o.fieldLabelSelector,o.populateTicketFields),c(o.ticketFieldsSelector).on("row:inserted",o.populateTicketFields),c(o.ticketFieldsSelector).on("row:deleted",o.populateTicketFields),c(o.labelVariablesSelector).on("click","a",o.insertLabelToEditor),c(o.ticketLinkVarSelector).on("click","a",o.insertLabelToEditor),c(o.ticketTokenVarSelector).on("click","a",o.insertLabelToEditor),c(o.ticketPostVarsSelector).on("click","a",o.insertLabelToEditor)},o.maybeUncheckTicket=function(e){var t=c(o.ticketTogglerSelector);if(t.length){var i=t.closest("label").attr("class").trim().split(" ").filter(function(e){return e.startsWith("hide_if_")}).map(function(e){return e.substring("hide_if_".length)}),l=c(e.target).val();0<=c.inArray(l,i)&&t.removeAttr("checked").trigger("change")}},o.toggleTicketPanels=function(e){var t=c(e.target).is(":checked");c(o.ticketPanels).toggle(t)},o.insertField=function(e){var t=c(this).data("row");return c(this).closest(o.ticketFieldsSelector).find("tbody").append(t),c(o.ticketFieldsSelector).trigger("row:inserted"),!1},o.deleteField=function(e){return c(this).closest("tr").remove(),c(o.ticketFieldsSelector).trigger("row:deleted"),!1},o.fieldTypeChange=function(e){var t=c(e.target);switch(t.val()){case"select":case"radio":case"checkbox":t.closest("tr").find(".field_options textarea").show(),t.closest("tr").find(".field_options .email-options").hide();break;case"email":t.closest("tr").find(".field_options textarea").hide(),t.closest("tr").find(".field_options .email-options").show();break;default:t.closest("tr").find(".field_options textarea").hide(),t.closest("tr").find(".field_options .email-options").hide()}return!1},o.populateTicketFields=function(){var e=c(o.fieldLabelSelector,o.ticketFieldsSelector);o.ticketFields=[],e.each(function(){o.ticketFields.push(this.value)}),o.updateLabelVariablesInfo()},o.updateLabelVariablesInfo=function(){o.ticketFields.length?(c(o.labelVariablesSelector).html(""),c.each(o.ticketFields,function(e,t){c(o.labelVariablesSelector).append('<a href="#"><code>{'+t+"}</code></a>")}),c(o.labelVariablesInfoSelector).show()):c(o.labelVariablesInfoSelector).hide()},o.insertLabelToEditor=function(){var e,t=c(this).closest(".woocommerce_options_panel"),i=c(this).text();switch(t.attr("id")){case"ticket_content_data":e=tinyMCE.get("ticket-content-editor");break;case"ticket_email_data":e=tinyMCE.get("ticket-email-editor")}return e.insertContent(i),!1},o.setDefaultFieldsIfEmpty=function(){if(!o.ticketFields.length){var t=["First Name","Last Name","Email"],i=["first_name","last_name","email"];c(o.insertFieldSelector,o.ticketFieldsSelector).trigger("click"),c(o.insertFieldSelector,o.ticketFieldsSelector).trigger("click"),c(o.insertFieldSelector,o.ticketFieldsSelector).trigger("click"),c("tbody tr",o.ticketFieldsSelector).each(function(e){c(o.fieldLabelSelector,this).val(t[e]).trigger("change"),c(o.fieldTypeSelector,this).val(i[e]).trigger("change")})}},o.setDefaultPrintContentIfEmpty=function(){o._setTinyMCEDefaultContent("ticket-content-editor",o.defaultPrintContent)},o.setDefaultEmailContentIfEmpty=function(){o._setTinyMCEDefaultContent("ticket-email-editor",o.defaultEmailContent)},o._setTinyMCEDefaultContent=function(e,t){var i=c("#"+e);i&&(i.val()||i.val(t))},c(o.init)}(jQuery);
