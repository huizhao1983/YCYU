!function(o){var l=o.extend({emailSubjectSelector:"#email-subject",emailPreviewButtonSelector:"#preview-email",emailBodyIframeSelector:"#ticket_email_editor_ifr",productId:"#product-id",emailPreviewSelector:"#email-preview-container"},wcBoxOfficeParams);l.init=function(){l.bindEvents()},l.bindEvents=function(){o(l.emailPreviewButtonSelector).on("click",l.previewEmail),o(l.pastEmailsSelector).on("click",l.deletePastEmailSelector,l.deletePastEmail)},l.previewEmail=function(e){var i=o(l.emailSubjectSelector).val(),t=o(l.productId).val(),r=o(l.emailBodyIframeSelector).contents().find("#tinymce").html();if(o(l.emailPreviewButtonSelector).attr("disabled","disabled").css("cursor","wait"),!t||!r)return alert(l.i18n_previewEmptyProductOrBody),void o(l.emailPreviewButtonSelector).removeAttr("disabled").css("cursor","pointer");o.post(l.ajaxurl,{action:l.previewEmailAction,product_id:t,content:r,subject:i,wc_box_office_admin_test_email_nonce:l.previewEmailNonce}).done(l.previewEmailDone)},l.previewEmailDone=function(e){o(l.emailPreviewSelector).html(e).slideDown("fast"),o(l.emailPreviewButtonSelector).removeAttr("disabled").css("cursor","pointer")},o(l.init)}(jQuery);
